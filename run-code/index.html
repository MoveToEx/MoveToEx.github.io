<meta charset="utf8">

<!-- <script src="/js/monaco-editor/min/vs/loader.js"></script> -->
<script src="/js/require-2.3.6.min.js"></script>
<script src="/js/jquery-3.5.1.min.js"></script>
<link href="//netdna.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">


<style>

body {
    background-color: rgb(245, 247, 249);
}

.run-btn {
    text-align: center;
    background-color: white;
    border: none;
    outline: none;
    border-radius: 4px;
    height: 50px;
    width: 400px;
    transition: linear 0.2s;
    margin: auto;
}

.run-btn span {
    display: block;
    text-align: center;
}

.run-btn:hover {
    background-color: gray;
    color: white;
    transition: linear 0.2s;
}

.run-btn[disabled]:hover {
    background-color: #aaa;
    color: white;
    transition: linear 0.2s;
}

.src-container {
    width: 800px;
    height: 600px;
    border: 1px solid grey;
    margin: auto;
}

.output-container {
    width: 800px;
    height: 100px;
    border: none;
    margin: auto;
}

.output-textfield[disabled] {
    width: 800px;
    height: 100px;
    background: white;
    border-color: black;
    color: black;
}
</style>

<div style="width: 800px; margin: auto;">
<h3>Source</h3>
<div class="src-container"></div>
</div>

<br/>

<div style="text-align: center;">
    <button id="run" class="run-btn">
        <span>
            <i class="fa fa-cog"></i> Run code
        </span>
    </button>
</div>

<br/>

<div class="output-container">
<h3>Output</h3>
<textarea class="output-textfield" type="text" cols="100" rows="100" value="" disabled></textarea>
</div>

<br/>

<script>

document.querySelector('.run-btn').addEventListener('click', function() {
    run();
});

var editor;

document.addEventListener('DOMContentLoaded', () => {
    require.config({ paths: { vs: '/js/monaco-editor/min/vs' } });
    require(['vs/editor/editor.main'], function () {
        editor = monaco.editor.create(document.querySelector('.src-container'), {
            value: [
                '// Fetching source...'
            ].join('\n'),
            language: 'cpp'
        });
        fetchCode();
    });
});
function run() {
    var req = JSON.stringify({
        "cmd": "g++ -std=c++2a main.cpp && ./a.out",
        "src": editor.getValue()
    });
    document.querySelector('.run-btn').disabled = true;
    document.querySelector('.run-btn').innerHTML = '<i class="fa fa-spin fa-cog"></i> Running...';
    $.post('http://coliru.stacked-crooked.com/compile', req, function(data) {
        document.querySelector('.output-textfield').value = data;
        document.querySelector('.run-btn').disabled = false;
        document.querySelector('.run-btn').innerHTML = '<i class="fa fa-cog"></i> Run code';
    })
}
function fetchCode(file) {
    var xhr = new XMLHttpRequest();
    var param = window.location.href.split('?')[1];
    xhr.open('GET', '/code/' + param, false);
    xhr.send();
    editor.setValue(xhr.response);
}
</script>

<p><br/><br><br/><br><br/><br><br/></p>
<div><br>Powered by<br><a href="https://github.com/Microsoft/monaco-editor" target="_blank" rel="noopener">monaco-editor</a>,<a href="http://coliru.stacked-crooked.com" target="_blank" rel="noopener">Coliru online compiler</a><br></div>